<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="with.studygroup.dao">
	<resultMap type="studygroup" id="studyGroup">
		<result column="group_no" property="groupNo"/>
		<result column="group_name" property="groupName"/>
		<result column="group_detail" property="groupDetail"/>
		<result column="group_maxperson" property="groupMaxPerson"/>
		<result column="group_nowperson" property="groupNowPerson"/>
		<result column="GROUP_ACTIVELONGITUDE" property="groupActiveLongitude"/>
		<result column="GROUP_ACTIVELATITUDE" property="groupActiveLatitude"/>
		<result column="GROUP_ACTIVEPLACE" property="groupActivePlace"/>
		<result column="group_email" property="groupEmail"/>
		<result column="GROUP_TEL" property="groupTel"/>
		<result column="GROUP_CONFIRMTYPE" property="groupConfirmType"/>
		<result column="GROUP_REPIMAGEPATH" property="groupRepImagePath"/>
		<result column="GROUP_RECRUITSTARTDATE" property="groupRecruitStartDate"/>
		<result column="GROUP_RECRUITENDDATE" property="groupRecruitEndDate"/>
		<result column="GROUP_REGDATE" property="groupRegDate"/>
	</resultMap>
	
	<!-- 스터디그룹 리스트 출력을 위한 쿼리문 -->
	<select id="studyList" resultMap="studyGroup">
		select 
			group_name, group_detail, group_maxperson, 
			group_nowperson, GROUP_ACTIVELONGITUDE, GROUP_ACTIVELATITUDE,
			GROUP_ACTIVEPLACE, group_email, GROUP_TEL, GROUP_CONFIRMTYPE, 
			GROUP_REPIMAGEPATH, GROUP_RECRUITSTARTDATE, GROUP_RECRUITENDDATE
		from t_with_studygroup
		limit #{startPage}, #{endPage}
	</select>
	
	<!-- 	스터디그룹 개설을 위한 쿼리문 -->
	<insert id="insertStudyGroup" parameterType="studygroup">
		insert into t_with_studygroup(
			group_name, group_detail, group_maxperson, 
			group_nowperson, GROUP_ACTIVELONGITUDE, GROUP_ACTIVELATITUDE,
			GROUP_ACTIVEPLACE, group_email, GROUP_TEL, GROUP_CONFIRMTYPE, 
			GROUP_REPIMAGEPATH, GROUP_RECRUITSTARTDATE, GROUP_RECRUITENDDATE
		)
		values(
			#{groupName}, #{groupDetail}, #{groupMaxPerson},
			'0', #{groupActiveLongitude}, #{groupActiveLatitude},
			#{groupActivePlace}, #{groupEmail}, #{groupTel}, #{groupConfirmType},
			#{groupRepImagePath}, #{groupRecruitStartDate}, #{groupRecruitEndDate}
		)
	</insert>
	
	<!-- 	가장 최근 증가값 가져오기 위한 쿼리문-->
	<select id="selectAutoIncrement" resultType="int">
		select max(group_no) from t_with_studygroup;
	</select>
	
	
	<!-- 	스터디그룹 이름 가져오기 위한 쿼리문 -->
	<select id="studyName" parameterType="int" resultType="String">
		select 
			group_name 
		from 
			t_with_studygroup
		where group_no = #{no};
	</select>
	
	<!-- 	스터디그룹 태그를 입력하기 위한 쿼리문 -->
	<insert id="insertStudyGroupTag" parameterType="studygrouptag">
		insert into T_WITH_STUDYGROUP_TAG(
			TAG_NAME, 
			GROUP_NO,
			GROUP_NAME)
		values(
			#{tagName},
			#{groupNo},
			#{groupName}
		)
	</insert>
</mapper>